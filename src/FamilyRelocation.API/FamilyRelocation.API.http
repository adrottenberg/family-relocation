@baseUrl = https://localhost:7267

# Variables - Update these for testing
@testEmail = your-email@example.com
@testPassword = YourPassword123!
@newPassword = NewPassword123!

### Login
# Returns tokens on success, or a challenge if password change required
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
    "email": "{{testEmail}}",
    "password": "{{testPassword}}"
}

### Respond to Challenge (NEW_PASSWORD_REQUIRED)
# Use after login returns a challenge - update session from login response
# The 'responses' field uses abstracted field names:
#   - newPassword: for NEW_PASSWORD_REQUIRED
#   - mfaCode: for SMS_MFA
#   - totpCode: for SOFTWARE_TOKEN_MFA
@challengeSession = paste-session-from-login-response
POST {{baseUrl}}/api/auth/respond-to-challenge
Content-Type: application/json

{
    "email": "{{testEmail}}",
    "challengeName": "NEW_PASSWORD_REQUIRED",
    "session": "{{challengeSession}}",
    "responses": {
        "newPassword": "{{newPassword}}"
    }
}

### Respond to Challenge (SMS_MFA)
# Example for SMS MFA challenge
@mfaCode = 123456
POST {{baseUrl}}/api/auth/respond-to-challenge
Content-Type: application/json

{
    "email": "{{testEmail}}",
    "challengeName": "SMS_MFA",
    "session": "{{challengeSession}}",
    "responses": {
        "mfaCode": "{{mfaCode}}"
    }
}

### Refresh Token
# Use the Cognito username (sub/UUID) from the idToken, not email
@cognitoUsername = paste-sub-from-id-token
@refreshToken = paste-refresh-token-here
POST {{baseUrl}}/api/auth/refresh
Content-Type: application/json

{
    "username": "{{cognitoUsername}}",
    "refreshToken": "{{refreshToken}}"
}

### Forgot Password
# Sends password reset code to email
POST {{baseUrl}}/api/auth/forgot-password
Content-Type: application/json

{
    "email": "{{testEmail}}"
}

### Confirm Forgot Password
# Complete password reset with code from email
@resetCode = 123456
POST {{baseUrl}}/api/auth/confirm-forgot-password
Content-Type: application/json

{
    "email": "{{testEmail}}",
    "code": "{{resetCode}}",
    "newPassword": "{{newPassword}}"
}

### Resend Confirmation Code
# Resend email verification code for unverified accounts
POST {{baseUrl}}/api/auth/resend-confirmation
Content-Type: application/json

{
    "email": "{{testEmail}}"
}

### Confirm Email
# Verify email with confirmation code
@confirmationCode = 123456
POST {{baseUrl}}/api/auth/confirm-email
Content-Type: application/json

{
    "email": "{{testEmail}}",
    "code": "{{confirmationCode}}"
}
