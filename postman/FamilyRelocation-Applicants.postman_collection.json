{
	"info": {
		"_postman_id": "family-relocation-applicants-collection",
		"name": "FamilyRelocation Applicants API",
		"description": "Collection for testing Applicants CRUD endpoints in the FamilyRelocation API.\n\n## Setup\n1. Import the Auth collection first and login to get an access token\n2. Set the `baseUrl` variable to your API URL (default: https://localhost:7267)\n\n## Endpoints\n- **Create Applicant**: Public endpoint (no auth required) for submitting new applicant families\n- **List Applicants**: Paginated list with search, filter, and sort (requires auth)\n- **Get Applicant by ID**: Protected endpoint (requires authentication)\n- **Update Applicant**: Update applicant details (requires authentication)\n- **Change Stage**: Transition housing search stage (requires authentication)\n- **Record Agreement**: Record signed agreements (requires authentication)\n- **Update Preferences**: Update housing preferences (requires authentication)\n- **Audit Logs**: View change history for entities (Admin only)\n\n## Test Flow\n1. Login via Auth collection to get tokens\n2. Create an applicant (no auth needed)\n3. Copy the returned ID to `applicantId` variable\n4. Record agreements, change stage, update preferences as needed\n5. View audit history to track all changes",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Applicants",
			"item": [
				{
					"name": "Create Applicant (Full)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('applicantId', jsonData.applicantId);",
									"    pm.collectionVariables.set('housingSearchId', jsonData.housingSearchId);",
									"    pm.test('Applicant created - IDs saved', function() {",
									"        pm.expect(jsonData.applicantId).to.be.a('string');",
									"        pm.expect(jsonData.housingSearchId).to.be.a('string');",
									"    });",
									"    console.log('Created applicant ID: ' + jsonData.applicantId);",
									"    console.log('Housing Search ID: ' + jsonData.housingSearchId);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"husband\": {\n        \"firstName\": \"Moshe\",\n        \"lastName\": \"Cohen\",\n        \"fatherName\": \"Yaakov\",\n        \"email\": \"moshe@example.com\",\n        \"phoneNumbers\": [\n            {\n                \"number\": \"2015551234\",\n                \"type\": \"Mobile\",\n                \"isPrimary\": true\n            }\n        ],\n        \"occupation\": \"Software Engineer\",\n        \"employerName\": \"Tech Corp\"\n    },\n    \"wife\": {\n        \"firstName\": \"Sarah\",\n        \"maidenName\": \"Goldstein\",\n        \"fatherName\": \"Avraham\",\n        \"email\": \"sarah@example.com\",\n        \"phoneNumbers\": [\n            {\n                \"number\": \"2015555678\",\n                \"type\": \"Mobile\",\n                \"isPrimary\": true\n            }\n        ],\n        \"occupation\": \"Teacher\",\n        \"employerName\": \"Bais Yaakov\",\n        \"highSchool\": \"Bais Yaakov of Brooklyn\"\n    },\n    \"address\": {\n        \"street\": \"123 Main St\",\n        \"street2\": \"Apt 4B\",\n        \"city\": \"Brooklyn\",\n        \"state\": \"NY\",\n        \"zipCode\": \"11230\"\n    },\n    \"children\": [\n        {\n            \"age\": 8,\n            \"gender\": \"Male\",\n            \"name\": \"Yosef\",\n            \"school\": \"Torah Academy\"\n        },\n        {\n            \"age\": 5,\n            \"gender\": \"Female\",\n            \"name\": \"Rivka\",\n            \"school\": \"Bais Yaakov\"\n        }\n    ],\n    \"currentKehila\": \"Flatbush\",\n    \"shabbosShul\": \"Young Israel\",\n    \"housingPreferences\": {\n        \"budgetAmount\": 500000,\n        \"minBedrooms\": 4,\n        \"minBathrooms\": 2.5,\n        \"requiredFeatures\": [\"Basement\", \"Garage\"],\n        \"moveTimeline\": \"ShortTerm\"\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants"
							]
						},
						"description": "Create a new applicant (family) for board approval.\n\n**No authentication required** - This is a public endpoint for families to submit their applications.\n\n**Response includes:**\n- `applicantId`: The created applicant ID\n- `housingSearchId`: The auto-created housing search ID\n- `applicant`: Full applicant details"
					}
				},
				{
					"name": "Create Applicant (Minimal)",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"husband\": {\n        \"firstName\": \"David\",\n        \"lastName\": \"Levy\"\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants"
							]
						},
						"description": "Create a minimal applicant with only required fields."
					}
				},
				{
					"name": "List Applicants",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/applicants?page=1&pageSize=20",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "20"
								},
								{
									"key": "search",
									"value": "",
									"disabled": true
								},
								{
									"key": "boardDecision",
									"value": "Pending",
									"disabled": true
								},
								{
									"key": "city",
									"value": "",
									"disabled": true
								},
								{
									"key": "stage",
									"value": "Submitted",
									"disabled": true,
									"description": "Filter by housing search stage: Submitted, HouseHunting, UnderContract, Closed, Paused, Rejected"
								},
								{
									"key": "sortBy",
									"value": "createdDate",
									"disabled": true
								},
								{
									"key": "sortOrder",
									"value": "desc",
									"disabled": true
								}
							]
						},
						"description": "Get a paginated list of applicants.\n\n**Query Parameters:**\n- `stage`: Filter by housing search stage (Submitted, HouseHunting, UnderContract, Closed, Paused, Rejected)\n- `boardDecision`: Filter by Pending, Approved, Rejected, Deferred\n- `search`: Search by name, email, or phone\n- `city`: Filter by city"
					}
				},
				{
					"name": "List Applicants by Stage (Pipeline)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/applicants?stage=HouseHunting",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants"
							],
							"query": [
								{
									"key": "stage",
									"value": "HouseHunting"
								}
							]
						},
						"description": "Get applicants filtered by housing search stage.\n\nUse this to build a Kanban/pipeline view by calling once per stage:\n- Submitted\n- HouseHunting\n- UnderContract\n- Closed\n- Paused\n- Rejected"
					}
				},
				{
					"name": "Get Applicant by ID",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}"
							]
						},
						"description": "Get full applicant details by ID."
					}
				},
				{
					"name": "Update Applicant",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"husband\": {\n        \"firstName\": \"Moshe\",\n        \"lastName\": \"Cohen\",\n        \"fatherName\": \"Yaakov\",\n        \"email\": \"moshe.updated@example.com\",\n        \"phoneNumbers\": [\n            {\n                \"number\": \"2015551234\",\n                \"type\": \"Mobile\",\n                \"isPrimary\": true\n            }\n        ],\n        \"occupation\": \"Senior Software Engineer\",\n        \"employerName\": \"Tech Corp Inc\"\n    },\n    \"currentKehila\": \"Union\",\n    \"shabbosShul\": \"Congregation Israel\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}"
							]
						},
						"description": "Update an existing applicant's information."
					}
				},
				{
					"name": "Delete Applicant (Soft Delete)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}"
							]
						},
						"description": "Soft delete an applicant. The applicant will no longer appear in list or pipeline queries but can be restored if needed."
					}
				}
			]
		},
		{
			"name": "Stage Transitions",
			"item": [
				{
					"name": "Record Broker Agreement",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"agreementType\": \"BrokerAgreement\",\n    \"documentUrl\": \"https://s3.amazonaws.com/family-relocation/agreements/broker-agreement-12345.pdf\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/agreements",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"agreements"
							]
						},
						"description": "Record that the broker agreement has been signed.\n\n**Required before starting house hunting.**\n\nUpload the signed document to S3 first, then call this with the URL."
					}
				},
				{
					"name": "Record Community Takanos",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"agreementType\": \"CommunityTakanos\",\n    \"documentUrl\": \"https://s3.amazonaws.com/family-relocation/agreements/takanos-12345.pdf\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/agreements",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"agreements"
							]
						},
						"description": "Record that the community takanos agreement has been signed.\n\n**Required before starting house hunting.**"
					}
				},
				{
					"name": "Change Stage - Start House Hunting",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"HouseHunting\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Transition from Submitted to HouseHunting.\n\n**Prerequisites:**\n1. Board approval (BoardReview.Decision = Approved)\n2. Broker agreement signed\n3. Community takanos signed"
					}
				},
				{
					"name": "Change Stage - Put Under Contract",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"UnderContract\",\n    \"contract\": {\n        \"propertyId\": \"00000000-0000-0000-0000-000000000000\",\n        \"price\": 475000,\n        \"expectedClosingDate\": \"2026-03-15\"\n    }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Transition from HouseHunting to UnderContract.\n\n**Required fields:**\n- `contract.price`: Contract price (must be > 0)\n\n**Optional fields:**\n- `contract.propertyId`: Property GUID\n- `contract.expectedClosingDate`: Expected closing date"
					}
				},
				{
					"name": "Change Stage - Record Closing",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"Closed\",\n    \"closingDate\": \"2026-03-15\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Transition from UnderContract to Closed.\n\n**Required fields:**\n- `closingDate`: Actual closing date"
					}
				},
				{
					"name": "Change Stage - Record Move In",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"MovedIn\",\n    \"movedInDate\": \"2026-04-01\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Transition from Closed to MovedIn.\n\n**Required fields:**\n- `movedInDate`: Move-in date"
					}
				},
				{
					"name": "Change Stage - Pause Search",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"Paused\",\n    \"reason\": \"Family taking a break for personal reasons\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Pause house hunting.\n\n**Optional fields:**\n- `reason`: Reason for pausing"
					}
				},
				{
					"name": "Change Stage - Resume Search",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"HouseHunting\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Resume house hunting from Paused state."
					}
				},
				{
					"name": "Change Stage - Contract Fell Through",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"HouseHunting\",\n    \"reason\": \"Inspection revealed foundation issues\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Return to HouseHunting when contract falls through.\n\nValid from: UnderContract, Closed\n\n**Optional fields:**\n- `reason`: Why the contract fell through\n\nThe failed contract is preserved in history."
					}
				},
				{
					"name": "Change Stage - Reject Application",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"newStage\": \"Rejected\",\n    \"reason\": \"Did not meet community requirements\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/stage",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"stage"
							]
						},
						"description": "Reject the application.\n\nValid from: Submitted\n\n**Optional fields:**\n- `reason`: Rejection reason\n\nThis is a terminal state - no further transitions allowed."
					}
				}
			]
		},
		{
			"name": "Housing Preferences",
			"item": [
				{
					"name": "Update Preferences (Full)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"budgetAmount\": 550000,\n    \"minBedrooms\": 4,\n    \"minBathrooms\": 2.5,\n    \"requiredFeatures\": [\"Basement\", \"Garage\", \"Yard\"],\n    \"shulProximity\": {\n        \"maxWalkingDistanceMiles\": 0.5,\n        \"anyShulAcceptable\": false\n    },\n    \"moveTimeline\": \"ShortTerm\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/preferences",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"preferences"
							]
						},
						"description": "Update housing preferences for an applicant.\n\n**Fields:**\n- `budgetAmount`: Maximum budget in USD\n- `minBedrooms`: Minimum bedrooms required\n- `minBathrooms`: Minimum bathrooms required\n- `requiredFeatures`: List of required features (e.g., Basement, Garage, Yard)\n- `shulProximity`: Shul proximity preferences\n- `moveTimeline`: When planning to move (Immediate, ShortTerm, MediumTerm, LongTerm, Extended, Flexible, NotSure)"
					}
				},
				{
					"name": "Update Preferences (Minimal)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"budgetAmount\": 450000,\n    \"minBedrooms\": 3\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/preferences",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"preferences"
							]
						},
						"description": "Update housing preferences with only budget and bedrooms."
					}
				}
			]
		},
		{
			"name": "Audit Logs",
			"item": [
				{
					"name": "Get All Audit Logs",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/audit-logs?page=1&pageSize=50",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"audit-logs"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "50"
								}
							]
						},
						"description": "Get all audit log entries. Admin only.\n\n**Query Parameters:**\n- `page`: Page number (default: 1)\n- `pageSize`: Items per page (default: 50, max: 100)"
					}
				},
				{
					"name": "Get Audit Logs with Filters",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/audit-logs?entityType=Applicant&action=Modified&from=2026-01-01&to=2026-12-31",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"audit-logs"
							],
							"query": [
								{
									"key": "entityType",
									"value": "Applicant",
									"description": "Filter by entity type (Applicant, HousingSearch)"
								},
								{
									"key": "action",
									"value": "Modified",
									"description": "Filter by action (Added, Modified, Deleted)"
								},
								{
									"key": "from",
									"value": "2026-01-01",
									"description": "Filter by timestamp (on or after)"
								},
								{
									"key": "to",
									"value": "2026-12-31",
									"description": "Filter by timestamp (on or before)"
								}
							]
						},
						"description": "Get audit logs with filters. Admin only.\n\n**Available Filters:**\n- `entityType`: Applicant, HousingSearch\n- `entityId`: Specific entity GUID\n- `userId`: User who made the change\n- `action`: Added, Modified, Deleted\n- `from`/`to`: Date range"
					}
				},
				{
					"name": "Get Audit Logs for Entity",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/audit-logs?entityType=Applicant&entityId={{applicantId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"audit-logs"
							],
							"query": [
								{
									"key": "entityType",
									"value": "Applicant"
								},
								{
									"key": "entityId",
									"value": "{{applicantId}}"
								}
							]
						},
						"description": "Get all audit entries for a specific entity."
					}
				},
				{
					"name": "Get Applicant History",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/audit-logs/applicant/{{applicantId}}?page=1&pageSize=50",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"audit-logs",
								"applicant",
								"{{applicantId}}"
							],
							"query": [
								{
									"key": "page",
									"value": "1"
								},
								{
									"key": "pageSize",
									"value": "50"
								}
							]
						},
						"description": "Convenience endpoint to get all audit history for a specific applicant. Useful for the Applicant detail page Activity tab."
					}
				}
			],
			"description": "Audit log endpoints for tracking all changes to Applicant and HousingSearch entities.\n\n**Admin Only**: These endpoints require the Admin role.\n\n**Tracked Entities:**\n- Applicant (Created, Modified, Deleted)\n- HousingSearch (Created, Modified, Deleted)\n\n**Response includes:**\n- Entity type and ID\n- Action (Added, Modified, Deleted)\n- Old/new values as JSON\n- User who made the change\n- Timestamp\n- IP address"
		},
		{
			"name": "Documents",
			"item": [
				{
					"name": "Get Document Types",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/document-types?activeOnly=true",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"document-types"
							],
							"query": [
								{
									"key": "activeOnly",
									"value": "true",
									"description": "If true (default), only return active document types"
								}
							]
						},
						"description": "Get all available document types.\n\n**Response includes:**\n- `id`: Document type ID (use this for uploads)\n- `name`: Internal name (e.g., BrokerAgreement)\n- `displayName`: Human-readable name (e.g., Broker Agreement)\n- `description`: Optional description\n- `isActive`: Whether the type is active\n- `isSystemType`: Whether it's a system-defined type"
					}
				},
				{
					"name": "Get Applicant Documents",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/documents/applicant/{{applicantId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"documents",
								"applicant",
								"{{applicantId}}"
							]
						},
						"description": "Get all documents uploaded for an applicant.\n\n**Response includes:**\n- `id`: Document ID\n- `documentTypeId`: Document type ID\n- `documentTypeName`: Document type name\n- `fileName`: Original filename\n- `storageKey`: S3 key (use for presigned URL)\n- `contentType`: MIME type\n- `fileSizeBytes`: File size\n- `uploadedAt`: Upload timestamp\n- `uploadedBy`: User who uploaded"
					}
				},
				{
					"name": "Upload Document",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.collectionVariables.set('documentKey', jsonData.uploadResult.documentKey);",
									"    pm.collectionVariables.set('documentId', jsonData.document.id);",
									"    pm.test('Document uploaded - IDs saved', function() {",
									"        pm.expect(jsonData.document.id).to.be.a('string');",
									"        pm.expect(jsonData.uploadResult.documentKey).to.be.a('string');",
									"    });",
									"    console.log('Document ID: ' + jsonData.document.id);",
									"    console.log('Storage Key: ' + jsonData.uploadResult.documentKey);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": ""
								},
								{
									"key": "applicantId",
									"value": "{{applicantId}}",
									"type": "text"
								},
								{
									"key": "documentTypeId",
									"value": "{{documentTypeId}}",
									"description": "Document type ID from GET /api/document-types",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/documents/upload",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"documents",
								"upload"
							]
						},
						"description": "Upload a document to S3.\n\n**Supported file types:** PDF, JPEG, PNG\n**Maximum file size:** 10MB\n\n**Parameters:**\n- `file`: The document file\n- `applicantId`: The applicant ID\n- `documentTypeId`: Document type ID (get from GET /api/document-types)\n\n**Response includes:**\n- `document`: The created document record\n- `uploadResult`: S3 upload details including documentKey and URL"
					}
				},
				{
					"name": "Upload Document (Legacy)",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": ""
								},
								{
									"key": "applicantId",
									"value": "{{applicantId}}",
									"type": "text"
								},
								{
									"key": "documentType",
									"value": "BrokerAgreement",
									"description": "Document type name (e.g., BrokerAgreement, CommunityTakanos)",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/documents/upload-legacy",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"documents",
								"upload-legacy"
							]
						},
						"description": "Legacy upload endpoint for backward compatibility.\n\nUses document type name instead of ID.\n\n**Supported file types:** PDF, JPEG, PNG\n**Maximum file size:** 10MB"
					}
				},
				{
					"name": "Delete Document",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/documents/{{documentId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"documents",
								"{{documentId}}"
							]
						},
						"description": "Delete a document from the database.\n\n**Note:** This removes the database record. The file in S3 may need separate cleanup."
					}
				},
				{
					"name": "Get Presigned URL",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/documents/presigned-url?documentKey={{documentKey}}&expiryMinutes=60",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"documents",
								"presigned-url"
							],
							"query": [
								{
									"key": "documentKey",
									"value": "{{documentKey}}",
									"description": "S3 object key from upload response"
								},
								{
									"key": "expiryMinutes",
									"value": "60",
									"description": "URL validity in minutes (default: 60, max: 1440)"
								}
							]
						},
						"description": "Get a pre-signed URL for temporary access to a document.\n\n**Parameters:**\n- `documentKey`: The S3 object key (from upload response)\n- `expiryMinutes`: URL validity in minutes (default: 60, max: 1440)\n\n**Response includes:**\n- `url`: Pre-signed URL to access the document\n- `expiresAt`: Expiration timestamp"
					}
				},
				{
					"name": "Get Stage Requirements",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/stage-requirements/BoardApproved/HouseHunting?applicantId={{applicantId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"stage-requirements",
								"BoardApproved",
								"HouseHunting"
							],
							"query": [
								{
									"key": "applicantId",
									"value": "{{applicantId}}",
									"description": "Optional: Check which documents are already uploaded for this applicant"
								}
							]
						},
						"description": "Get document requirements for a stage transition.\n\n**Parameters:**\n- `fromStage`: The current stage (e.g., BoardApproved)\n- `toStage`: The target stage (e.g., HouseHunting)\n- `applicantId` (optional): Check which documents are already uploaded\n\n**Response includes:**\n- `fromStage`: Current stage\n- `toStage`: Target stage\n- `requirements`: List of required documents with:\n  - `documentTypeId`: Document type ID\n  - `documentTypeName`: Document type name\n  - `isRequired`: Whether the document is required\n  - `isUploaded`: Whether the document has been uploaded (if applicantId provided)"
					}
				}
			],
			"description": "Document upload and retrieval endpoints.\n\n**Workflow:**\n1. Get available document types: GET /api/document-types\n2. Get stage requirements: GET /api/stage-requirements/{from}/{to}\n3. Upload document using POST /api/documents/upload with documentTypeId\n4. View applicant documents: GET /api/documents/applicant/{id}\n5. Download document: GET /api/documents/presigned-url"
		},
		{
			"name": "Board Review",
			"item": [
				{
					"name": "Set Board Decision - Approved",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"decision\": \"Approved\",\n    \"notes\": \"Strong references from Rabbi Cohen. Family is well-suited.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/board-review",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"board-review"
							]
						},
						"description": "Records the board's approval decision. Does NOT automatically change the stage - use POST /approve after this to transition to BoardApproved stage."
					}
				},
				{
					"name": "Set Board Decision - Rejected",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"decision\": \"Rejected\",\n    \"notes\": \"Does not meet community requirements.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/board-review",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"board-review"
							]
						},
						"description": "Records the board's rejection decision. Does NOT automatically change the stage - use POST /reject after this to transition to Rejected stage."
					}
				},
				{
					"name": "Set Board Decision - Deferred",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"decision\": \"Deferred\",\n    \"reviewDate\": \"2026-02-01\",\n    \"notes\": \"Waiting for additional references.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/board-review",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"board-review"
							]
						},
						"description": "Records that the board deferred their decision. Applicant remains in Submitted stage for future review."
					}
				},
				{
					"name": "Reject Applicant",
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{accessToken}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"reason\": \"Did not meet community requirements.\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/applicants/{{applicantId}}/reject",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"applicants",
								"{{applicantId}}",
								"reject"
							]
						},
						"description": "Transitions the housing search from Submitted to Rejected stage.\n\n**Prerequisite:** Board decision must be set to \"Rejected\" first via PUT /board-review."
					}
				}
			],
			"description": "Board review workflow endpoints.\n\n**Workflow:**\n1. Board reviews application at meeting\n2. Coordinator records decision via PUT /board-review\n3. If Approved: Use POST /approve (UV-30) to transition to BoardApproved\n4. If Rejected: Use POST /reject to transition to Rejected\n5. If Deferred: No stage change, review again at future meeting\n\n**Stage Flow:**\n- Submitted → BoardApproved (on approval) → HouseHunting (after agreements)\n- Submitted → Rejected (on rejection)"
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "https://localhost:7267",
			"type": "string"
		},
		{
			"key": "accessToken",
			"value": "",
			"type": "string"
		},
		{
			"key": "applicantId",
			"value": "",
			"type": "string"
		},
		{
			"key": "housingSearchId",
			"value": "",
			"type": "string"
		},
		{
			"key": "documentKey",
			"value": "",
			"type": "string"
		},
		{
			"key": "documentId",
			"value": "",
			"type": "string"
		},
		{
			"key": "documentTypeId",
			"value": "",
			"type": "string"
		}
	]
}
